<!doctype html>
<html lang="pl" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Czlonkowie</title>
    <link rel="stylesheet" href="/css/app.css" />
    <style>
        .people-grid {
            display: grid;
            gap: 10px;
            margin-top: 16px;
        }
        .people-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr auto;
            gap: 10px;
            align-items: center;
        }
    </style>
</head>
<body class="bg">
<div class="shell">
    <div class="card wide">
        <div class="row">
            <h1>Czlonkowie</h1>
            <a class="ghost" href="/dashboard">Powrot</a>
        </div>

        <div th:if="${notice}" class="notice" style="margin:8px 0 12px;" th:text="${notice}">OK</div>
        <div th:if="${error}" class="notice" style="margin:8px 0 12px; border-color:#b42318; background:#fef3f2; color:#7a271a;" th:text="${error}">Blad</div>

        <div class="notice" style="margin-top:16px;">Dodaj / edytuj osoby i role</div>
        <div class="people-grid">
            <form class="people-row" th:each="row : ${pointsRows}" method="post" action="/people/update">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <input type="hidden" name="personId" th:value="${row.person.id}" />
                <input type="hidden" name="tab" value="members" />
                <input type="text" name="displayName" th:value="${row.person.displayName}" required />
                <select name="role">
                    <option th:each="role : ${roles}" th:value="${role}" th:text="${role}" th:selected="${role} == ${row.person.role}">ROLE</option>
                </select>
                <input type="number" name="basePoints" th:value="${row.person.basePoints}" />
                <div class="row" style="gap:6px;">
                    <button type="submit" class="primary">Zapisz</button>
                    <button type="submit" class="ghost" formaction="/people/delete">Usun</button>
                </div>
            </form>
        </div>

        <div class="notice" style="margin-top:16px;">Dodaj nowa osobe</div>
        <form class="people-row" method="post" action="/people/add">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <input type="hidden" name="tab" value="members" />
            <input type="text" name="displayName" placeholder="Imie i nazwisko" required />
            <select name="role">
                <option th:each="role : ${roles}" th:value="${role}" th:text="${role}">ROLE</option>
            </select>
            <input type="number" name="basePoints" value="0" />
            <button type="submit" class="primary">Dodaj</button>
        </form>
    </div>
</div>
</body>
</html>
